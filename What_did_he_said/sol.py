from rsa import rsa, chartohex
from base64 import b64decode
n = '00:c9:5c:88:b4:de:49:89:a5:ff:b9:26:c7:94:54:4e:85'
def cv(s):
	n = len(s)
	print s
	ans = 0
	for i in range(n):
		if (s[i]>='0' and s[i]<='9'):
			ans = ans * 16 + ord(s[i]) - 48
		else:
			ans = ans * 16 + ord(s[i]) - 97 + 10
	return ans
def cv1(s):
	n = len(s)
	print s
	ans = 0
	for i in range(n):
		ans = ans * 256 + ord(s[i])
	return ans

n = cv(n.replace(':',''))

print n 
n1 = '00:e7:a2:b8:c5:a8:6d:fb:7d:7c:6b:32:20:1d:b7:43:8b'
n1 = cv(n1.replace(':',''))

print n1
f = open("encrypt.txt", "r")
s = f.read()
c = s.replace('\n','')
print c
c = cv1(c)
print c

f.close()

p =  14673311234908966559
q = n // p
e = (1<<16) + 1


p1 =  16879405341365159057
q1 = n1 // p1
e1 = (1<<16) + 1


N = 0x9cdebcfaae6c9258e6c53b70bc103763b1fbe71c34d2ed33af30abf36686fb6534e9d3c693252e8921f6d2fb8bc6db78fdb6981eab9fb5268e5e12f0647d745d38926c63d6a08d566d2d2d028bbeec830025bf13f8448c68bd0f23c6d8156a7cdec4851cb14f4d784e06bbbc47c740829f35054f573fe772b519bdf625afd45fadcf735cf22ee08594829f7f371252c4723833bb1d0e27e87987994144b2a709ddce504cd4f2f2328d284024ed38b92456addaee2004506539ed0920bcf0beb1a12cdfa986253bc2cf503967985bb658dacf130bccec8bb8656c973f2455ef7301cb33fdd183531fdebcf3eca1bfe9c8c8ae1bbdac3112b80a58000000000001
p3 = 124409136380411409843862611857222348665477227795534040921707517831179433136563731143717097593429107485990419335523497586091902909417091518853111460154659065334509031305786604578745725202525525729590745745392133433241978137775425101939566431337818954522026823336322106691408411698737864441711615279104000000001
q3 = N // p3
e3 = (1<<16) + 1
c3 = 0x8cd7457734ed6337b78c970f831e4a9ac19fb2352ebb11a984f0d5028c5fc041967a1d966bd41b6cab32a45634c7fd64028103466b4c20d121a720cba8ecf0369bc43b8cd8ffa80b92b44091b7a8e6978c773bd0b4029bb20424c16ad563586b8702f5af3efa107cc3425e74cbb9bded983f7d1b90a0b64e7a1293cfd06c864c1c3baec253f504a9b2bed12727d4a3fda1b8563b66ec8b80c603661ff91a27a89475a1eaed5b717afd7e3687aa295a2526200f306b9abf5b5a90afafb61d0d942592b57a88d7366e5931cd277b264b5474202e8a854778ba5b8e86833ccc63e52a41845eec557fb8752bfd6eeec84c19af90baa53bb0b4aa86c2fd81aa6a4563
#print rsa(p1 , q1 , e , c)


p = 14606124773267989759790608461455191496412830491696356154942727371283685352374696106605522295947073718389291445222948819019827919548861779448943538887273671755720708995173224464135442610773913398114765000584117906488005860577777765761976598659759965848699728860137999472734199231263583504465555230926206555745572068651194660027408008664437845821585312159573051601404228506302601502000674242923654458940017954149007122396560597908895703129094329414813271877228441216708678152764783888299324278380566426363579192681667090193538271960774609959694372731502799584057204257039655016058403786035676376493785696595207371994520
q = 14606124773267989759790608461455191496412830491696356154942727371283685352374696106605522295947073718389291445222948819019827919548861779448943538887273671755720708995173224464135442610773913398114765000584117906488005860577777765761976598659759965848699728860137999472734199231263583504465555230926206555745568763680874120108583912617489933976894172558366109559645634758298286470207143481537561897150407972412540709976696855267154744423609260252738825337344339874487812781362826063927023814123654794249583090654283919689841700775405866650720124813397785666726161029434903581762204459888078943696756054152989895680616

c = 15507598298834817042463704681892573844935925207353671096676527782423920390858333417805014479686241766827314370902570869063203100704151010294869728739155779685640415815492312661653450808873691693721178331336833872996692091804443257630828512131569609704473214724551132715672202671586891813211353984388741035474991608860773895778988812691240069777435969326282770350038882767450912160134013566175657336041694882842590560100668789803775001750959648059363722039014522592751510672658328196379883088392541680852726136345115484827400366869810045573176782889745710174383221427352027041590910694360773085666697865554456816396551
print rsa(p , q , e , c)
